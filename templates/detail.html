{% extends "base.html" %}
{% block content %}
<input type="hidden" value="{{start}}" id="start_3" />
<input type="hidden" value="{{end}}" id="end_3"/>
<input type="hidden" value="{{num_person}}" id="persons_3"/>
<input type="hidden" value="{{location}}" id="location_3"/>
<input type="hidden" value="{{hotel.objectId}}" id="hotel_3"/>
<div class="container">
    <ul class="breadcrumb">
        <li><a href="index.php">Нүүр</a>
        </li>
        <li><a href="index.php?city={{location}}">{{location}}</a>
        </li>
        <li class="active">{{hotel.name}}</li>
    </ul>
    <div class="booking-item-details">
        <header class="booking-item-header">
            <div class="row" style="padding:10px">
                <div class="col-md-9" >
                    <div class='flex middle'>
                        <h2 class="lh1em">{{hotel.name}}</h2>
                        <div class="booking-item-meta">
                            <div class="booking-item-rating">
                                <ul class="icon-list icon-group booking-item-rating-stars">
                                    {% for room in rooms %}
                                    <li><i class="fa fa-star"></i></li>   
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                    </div>
                    <p class="lh1em text-small"><i class="fa fa-map-marker"></i>  {{hotel.address}}</p>
                    <ul class="list list-inline text-small">
                        <li><a href="#"><i class="fa fa-envelope"></i> {{hotel.email}}</a>
                        </li>
                        <li><a href="#"><i class="fa fa-home"></i> {{hotel.website}}</a>
                        </li>
                        <li><i class="fa fa-phone"></i> {{hotel.phone}}</li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <p class="booking-item-header-price"><small></small>  <span class="text-lg">US$ {{hotel.average_rate}}</span>/өдөр</p>
                </div>
            </div>
            <div class="col-md-3">
                <p class="booking-item-header-price"><small></small>  <span class="text-lg">Test</span>/test</p>
            </div>
            <div class="col-md-3">
                <p class="booking-item-header-price"><small></small>  <span class="text-lg">US$ {{hotel.average_rate}}</span>/өдөр</p>
            </div>
        </header>
        <div class="row">
            <div class="col-md-6">
                <div class="tabbable booking-details-tabbable">
                    <ul class="nav nav-tabs" id="myTab">
                        <li class="active"><a href="#tab-1" data-toggle="tab"><i class="fa fa-camera"></i>Images</a>
                        </li>

                        </li>
                    </ul>
                    <div class="tab-content">
                        <div class="tab-pane fade in active" id="tab-1">
                            <div class="fotorama" data-allowfullscreen="true" data-nav="thumbs">
                                {% for image in hotel.images %}
                                <img src="{{image}}" alt="Image Alternative text" title="hotel PORTO BAY SERRA GOLF living room" />  
                                {% endfor %}

                            </div>
                        </div>

                    </div>
                </div>
                <div class="col-md-6">
                    <div class="row">
                        <div class="col-md-12">
                            <p style="text-align: justify;">{{hotel.long_desc}}
                            </p>
                        </div>
                        <div class="gap gap-small"></div>
                        <div id="map-canvas" style="height:200px; margin-left:10px"></div>
                        <!-- <div class="col-md-12 active" id="google-map-tab">
                                <div id="map-canvas" style="width:100%; height:140px;"></div>
                            </div>-->
                    </div>  
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <p style="text-align: justify;">{{hotel.long_desc}}
                        </p>
                    </div>
                    <div class="gap gap-small"></div>
                    <!-- <div class="col-md-12 active" id="google-map-tab">
                                    <div id="map-canvas" style="width:100%; height:140px;"></div>
                                </div>-->
                </div>  
            </div>
        </div>
    </div>
    <div class="gap"></div>
    <h3>Өрөөний сонголт</h3>
    <div class="row">
        <div class="col-md-9">
            <div class="booking-item-dates-change">
                <form>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="input-daterange" data-date-format="MM d, D">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group form-group-icon-left"><i class="fa fa-calendar input-icon input-icon-hightlight"></i>
                                            <label>Ирэх</label>
                                            <input class="form-control"  type="text" id="start" />
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group form-group-icon-left"><i class="fa fa-calendar input-icon input-icon-hightlight"></i>
                                            <label>Гарах</label>
                                            <input class="form-control"  type="text" id="end"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group form-group-select-plus">
                                <label>Том хүн</label>
                                <select class="form-control " id="num_people">
                                    <option selected="selected">1</option>
                                    <option>2</option>
                                    <option>3</option>
                                    <option>4</option>
                                    <option>5</option>
                                    <option>6</option>
                                    <option>7</option>
                                    <option>8</option>
                                    <option>9</option>
                                    <option>10</option>
                                    <option>11</option>
                                    <option>12</option>
                                    <option>13</option>
                                    <option>14</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group form-group-select-plus">
                                <label>Хүүхэд</label>

                                <select class="form-control">
                                    <option selected="selected">0</option>
                                    <option>1</option>
                                    <option>2</option>
                                    <option>3</option>
                                    <option>4</option>
                                    <option>5</option>
                                    <option>6</option>
                                    <option>7</option>
                                    <option>8</option>
                                    <option>9</option>
                                    <option>10</option>
                                    <option>11</option>
                                    <option>12</option>
                                    <option>13</option>
                                    <option>14</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group form-group-select-plus">
                                <label>&nbsp;</label>
                                <a class="btn btn-primary btn-md" id="search_a" >Хайх</a>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="gap gap-small"></div>
            <ul id="rooms" class="booking-list">
                {% for room in rooms %}
                <li>
                <a name="order" class="booking-item" id="{{room.objectId}}">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="fotorama" data-allowfullscreen="true" data-nav="thumbs">
                                {% for image in room.images %}
                                <img src="{{image}}" alt="Image Alternative text" title="hotel PORTO BAY SERRA GOLF living room" />  
                                {% endfor %}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h5 class="booking-item-title">{{room.name}}</h5>
                            <p class="text-small">{{room.short_desc}}</p>
                            <ul class="booking-item-features booking-item-features-sign clearfix">
                                <li rel="tooltip" data-placement="top" title="Adults Occupancy"><i class="fa fa-male"></i><span class="booking-item-feature-sign">x {{room.adult_occupancy}}</span>
                                </li>
                                <li rel="tooltip" data-placement="top" title="Children Occupancy"><i class="fa fa-child"></i><span class="booking-item-feature-sign">x {{room.child_occupancy}}</span>
                                </li>
                                <li rel="tooltip" data-placement="top" title="Beds"><i class="fa fa-bed"></i><span class="booking-item-feature-sign">x {{room.num_beds}}</span>
                                </li>
                                <li rel="tooltip" data-placement="top" title="Room footage (square feet)"><i class="fa fa-expand"></i><span class="booking-item-feature-sign">{{room.roomt_size}} m2</span>
                                </li>
                            </ul>
                            <ul class="booking-item-features booking-item-features-small clearfix">
                                <li rel="tooltip" data-placement="top" title="Air Conditioning"><i class="im im-air"></i>
                                </li>
                                <li rel="tooltip" data-placement="top" title="Flat Screen TV"><i class="fa fa-television"></i>
                                </li>
                                <li rel="tooltip" data-placement="top" title="Mini Bar"><i class="im im-bar"></i>
                                </li>
                                <li rel="tooltip" data-placement="top" title="Bathtub"><i class="im im-bathtub"></i>
                                </li>
                                <li rel="tooltip" data-placement="top" title="Kitchen"><i class="im im-kitchen"></i>
                                </li>
                                <li rel="tooltip" data-placement="top" title="Patio"><i class="im im-patio"></i>
                                </li>
                                <li rel="tooltip" data-placement="top" title="Washing Machine"><i class="im im-washing-machine"></i>
                                </li>
                                <li rel="tooltip" data-placement="top" title="Pool"><i class="im im-pool"></i>
                                </li>
                            </ul>
                        </div>
                        <div class="col-md-3"><span class="booking-item-price">${{room.night_price}}</span><span>/өдөр</span>
                            <div class="form-group form-group-select-plus">
                                <label>Өрөөний тоо</label>
                                <select class="form-control form-group-select-plus" name="qty" room="{{room.room_type}}" price="{{room.night_price}}" roomid="{{room.objectId}}" > 
                                    <option selected="selected">0</option>
                                    <option>1</option>
                                    <option>2</option>
                                    <option>3</option>
                                    <option>4</option>
                                    <option>5</option>
                                    <option>6</option>
                                    <option>7</option>
                                    <option>8</option>
                                    <option>9</option>
                                    <option>10</option>
                                    <option>11</option>
                                    <option>12</option>
                                    <option>13</option>
                                    <option>14</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </a>
                </li>
                {% endfor %}
            </ul>
        </div>
        <div class="col-md-3">
            <div id="payment_info" class="booking-item-payment" style="display:none">
                <ul class="booking-item-payment-details" style="width:100%">
                    <li>
                    <h5>Буудлах нийт хоног: <span id="days"><span></h5>
                            <div class="booking-item-payment-date">
                                <p class="booking-item-payment-date-day" id="checkin">2016-07-11</p>
                            </div><i class="fa fa-arrow-right booking-item-payment-date-separator"></i>
                            <div class="booking-item-payment-date">
                                <p class="booking-item-payment-date-day" id="checkout">2016-07-11</p>
                            </div>
                            </li>
                            <li>
                            <h5>Өрөө</h5>

                            <span id="payment_rooms">

                                <!-- <ul class="booking-item-payment-price">
                                                    <li>
                                                        <p class="booking-item-payment-price-title">Twin</p>
                                                        <p class="booking-item-payment-price-title" style="margin-left:10px">2<small>/rooms</small></p>
                                                        <p class="booking-item-payment-price-amount">$453<small>/per day</small></p>
                                                    </li>
                                                </ul>
                                                <ul class="booking-item-payment-price">
                                                    <li>
                                                        <p class="booking-item-payment-price-title">Twin</p>
                                                        <p class="booking-item-payment-price-title" style="margin-left:10px">2<small>/rooms</small></p>
                                                        <p class="booking-item-payment-price-amount">$453<small>/per day</small></p>
                                                    </li>
                                                </ul>-->

                            </span>

                            <ul class="booking-item-payment-price">
                                <li>
                                <p class="booking-item-payment-price-title">НӨАТ</p>
                                <p class="booking-item-payment-price-amount">(incluled)<small>/өдөр</small>
                                </p>
                                </li>
                            </ul>
                            </li>
                        </ul>
                        <p class="booking-item-payment-total">Нийт дүн: <span id="total"> 4232</span>
                        </p>
                        <span name="order" class="btn btn-primary" id="{{room.objectId}}" style="width:100%">Төлбөр төлөх</span>
                    </div>
                    <h4>Буудалын давуу талууд</h4>
                    <ul class="booking-item-features booking-item-features-expand mb30 clearfix">
                        <li><i class="im im-wi-fi"></i><span class="booking-item-feature-title">Wi-Fi Интернет</span>
                        </li>
                        <li><i class="im im-parking"></i><span class="booking-item-feature-title">Зогсоол</span>
                        </li>
                        <li><i class="im im-bus"></i><span class="booking-item-feature-title">Тосох үйлчилгээ</span>
                        </li>
                        <li><i class="im im-fitness"></i><span class="booking-item-feature-title">Финтнес</span>
                        </li>
                        <li><i class="im im-pool"></i><span class="booking-item-feature-title">Усан сан</span>
                        </li>
                        <li><i class="im im-spa"></i><span class="booking-item-feature-title">Саун</span>
                        </li>
                        <li><i class="im im-restaurant"></i><span class="booking-item-feature-title">Зоогийн газар</span>
                        </li>

                        <li><i class="im im-business-person"></i><span class="booking-item-feature-title">Бизнес төв</span>
                        </li>
                        <li><i class="im im-children"></i><span class="booking-item-feature-title">Хүүхдийн өрөө</span>
                        </li>
                    </ul>
                </div>
            </div>           
        </div>
        <div class="gap gap-small"></div>
    </div>
</div>
{% endblock %}
{% block scripting %}
    {{parent()}}
    <script type="text/javascript">
        function set_total(d){
             var total=0;
             $('span[name=subtotal]').each(function(){
                var sub = $(this).text();
                total = total + parseInt(sub);
             });
             total = parseInt(d) * total;
             $("#total").text("US$ "+total);
        }
        $(document).ready(function() {
            var start =$("#start_3").val();
            var end =$("#end_3").val();
            var formattedDate = new Date(start);
            var formattedDate1 = new Date(end);

            $("#start").datepicker({"autoclose": true}).on("change", function() {
                $("#end").focus();
            }).datepicker('setDate', formattedDate);
            $("#start").datepicker({ dateFormat: 'dd-mm-yy' });
            $("#end").datepicker({"autoclose": true}).on("change", function() {
                $("#num_people").focus();
            }).datepicker('setDate', formattedDate1).datepicker({ dateFormat: 'dd-mm-yy' });
            
            $("span[name=order]").click(function( event ) {
                var curId = $(this).attr('id');
                var start = $("#start_3").val();
                var end = $("#end_3").val();
                var location = $("#location_3").val();
                var hotel = $("#hotel_3").val();
                var country = $("#country").val();
                var url = "index.php?payment=" + curId +"&depart=" + start + "&end=" + end + "&location=" +location+"&hotel="+hotel; 
                window.location.replace(url);
            });
            $('select[name=qty]').each(function(){
                $(this).change(function(){
                    var start =$("#start").val();
                    var end =$("#end").val();
                    var starta = new Date(start);
                    var enda   = new Date(end);
                    var diff = new Date(enda - starta);
                    // get days
                    var days = diff/1000/60/60/24;
                    if($(this).val()>0){
                        var roomid = $(this).attr('roomid');
                        $('ul[name='+roomid+']').remove();
                        $("#payment_info").show();
                        

                        $("#checkin").text(start);
                        $("#checkout").text(end);
                        $("#days").text(days);

                        var room_name = $(this).attr('room');
                        var price = $(this).attr('price');
                        var subtotal = $(this).val()* price;

                        $("#payment_rooms").append('<ul name ="'+roomid+'" class="booking-item-payment-price"><li><p class="booking-item-payment-price-title">'+room_name+'</p><p class="booking-item-payment-price-title" style="margin-left:10px">'+$(this).val()+'<small>/rooms</small></p><p class="booking-item-payment-price-amount">$ <span><span name="subtotal">'+subtotal+'</span><small>/per day</small></p></li></ul>'
                        );
                        set_total(days);
                    }else{
                        var roomid = $(this).attr('roomid');
                        $('ul[name='+roomid+']').each(function(){
                            $(this).remove();
                        });
                        set_total(days);
                    }
                });
            });

            $("#search_a").click(function( event ) {
                $('select[name=qty]').each(function(){
                    $(this).val("0");
                });
                $("#payment_info").hide();
               //ajax lisr available rooms  
            });
            /*$("a[name=order]").click(function( event ) {
                var curId = $(this).attr('id');
                var start = $("#start_3").val();
                var end = $("#end_3").val();
                var location = $("#location_3").val();
                var hotel = $("#hotel_3").val();
                var country = $("#country").val();
                var url = "index.php?payment=" + curId +"&depart=" + start + "&end=" + end + "&location=" +location+"&hotel="+hotel; 
                window.location.replace(url);
            });*/
        }); 
    </script>
{% endblock %}
